AUTOA-RPA â€” ä»¥å½±åƒè¾¨è­˜èˆ‡éµé¼ æ¨¡æ“¬è‡ªå‹•åŒ– LINE æ¡Œé¢ç‰ˆ

READMEï¼ˆåˆç‰ˆ v0.1.0ï¼‰ â€” å°ˆæ¡ˆèªªæ˜èˆ‡ä¸Šæ‰‹æŒ‡å—
âš ï¸ é‡è¦è²æ˜
æœ¬å°ˆæ¡ˆåƒ…ä¾›å…§éƒ¨ç ”ç©¶èˆ‡å€‹äººè‡ªå‹•åŒ–ç”¨é€”ã€‚è«‹å…ˆå–å¾—æ”¶ä»¶è€…æ˜ç¢ºåŒæ„ã€éµå®ˆ LINE èˆ‡ä½œæ¥­ç³»çµ±/æ‡‰ç”¨ç¨‹å¼ä¹‹æœå‹™æ¢æ¬¾èˆ‡å„åœ°æ³•è¦ã€‚è«‹é¿å…æ¿«ç™¼è¨Šæ¯ã€è©é¨™æˆ–ä¾µå®³éš±ç§ä¹‹ç”¨é€”ã€‚ä½ éœ€è‡ªè¡Œæ‰¿æ“”ä½¿ç”¨é¢¨éšªï¼ˆå°é–ã€å‡çµã€æ³•å‹™é¢¨éšªç­‰ï¼‰ã€‚

1. å°ˆæ¡ˆç›®æ¨™

åœ¨ ä¸ä½¿ç”¨å®˜æ–¹ Messaging API çš„å‰æä¸‹ï¼Œä»¥ OpenCV å½±åƒè¾¨è­˜ + PyAutoGUI/pywinauto éµé¼ æ¨¡æ“¬ è‡ªå‹•åŒ– LINE æ¡Œé¢ç‰ˆçš„ç›¸ç°¿/åœ–ç‰‡æ‰¹é‡ç™¼é€èˆ‡ç›¸é—œæ“ä½œï¼ˆæ–°å¢/åˆªé™¤/æ¸…ç©ºã€åˆ‡æ›ç›¸ç°¿ã€åˆ†æ‰¹ç™¼é€ã€ç¯€æµèˆ‡æ’ç¨‹ï¼‰ã€‚

2. åŠŸèƒ½æ¦‚è¦½ï¼ˆMVPï¼‰

ğŸ“¸ ç›¸ç°¿/åœ–ç‰‡ç™¼é€æµç¨‹è‡ªå‹•åŒ–ï¼šé–‹å•ŸèŠå¤©â†’æ’å…¥ç›¸ç°¿/åœ–ç‰‡â†’è¼¸å…¥æ¨™é¡Œâ†’é€å‡º

ğŸ§­ UI æ¨¡æ¿å®šä½ï¼šå¤šè§£æåº¦æ¨¡æ¿æ¯”å°ï¼ˆè¼‰å…¥ templates/ PNG ä½œç‚ºå®šä½éŒ¨é»ï¼‰

ğŸ–±ï¸ éµé¼ é©…å‹•ï¼šé»æ“Šã€æ‹–æ”¾ã€è¼¸å…¥æ–‡å­—ã€å¿«æ·éµã€æ»¾å‹•

ğŸ§± ä»»å‹™ DSLï¼ˆYAMLï¼‰ï¼šä»¥ YAML æè¿°ä¸€å€‹ã€Œæµç¨‹è…³æœ¬ã€èˆ‡åƒæ•¸

ğŸ›¡ï¸ ç¯€æµ/äººé¡åŒ–ï¼šéš¨æ©Ÿå»¶é²ã€æ¯è¼ªä¸Šé™ã€é»‘åå–®ã€é€€è¨‚åå–®

â™»ï¸ å®¹éŒ¯æ¢å¾©ï¼šé€¾æ™‚é‡è©¦ã€å¤±æ•—æˆªåœ–ã€å¯å¾æŒ‡å®šæ­¥é©ŸçºŒè·‘

ğŸ—“ï¸ æ’ç¨‹ï¼šWindows æ’ç¨‹å™¨ï¼ˆæˆ–å…§å»º APSchedulerï¼‰

ğŸ§¾ æ—¥èªŒèˆ‡è­‰æ“šï¼šlogs/ã€reports/ã€ï¼ˆå¯é¸ï¼‰è¢å¹•éŒ„å½±

3. ç³»çµ±éœ€æ±‚

OSï¼šWindows 10/11ï¼ˆæ¡Œé¢ç‰ˆ LINEï¼‰

é¡¯ç¤ºï¼šå»ºè­° 1920Ã—1080ã€DPI ç¸®æ”¾ 100%ï¼ˆä¸ä¸€è‡´æœƒå½±éŸ¿æ¨¡æ¿æ¯”å°ï¼‰

Pythonï¼š3.10+ï¼ˆå»ºè­° 3.11ï¼‰

ç¡¬é«”ï¼šå»ºè­° RAM 8GB+

æ¬Šé™ï¼šå»ºè­°ä¸€èˆ¬æ¬Šé™å³å¯ï¼Œè‹¥ UAC é˜»æ“‹å†ä»¥ç³»çµ±ç®¡ç†å“¡å•Ÿå‹•

ä¾è³´å¥—ä»¶ï¼ˆæœƒåœ¨ requirements.txt çµ±ä¸€å®‰è£ï¼‰

pyautogui, opencv-python, numpy, pillow

pywinautoï¼ˆå¯é¸ï¼Œåšè¦–çª—èšç„¦/å®¹éŒ¯ï¼‰

pytesseractï¼ˆå¯é¸ï¼ŒOCR æ ¡é©—æ–‡å­—ï¼‰

apscheduler, python-dotenv, pyyaml, loguru

4. å®‰è£æ­¥é©Ÿ
# 1) å–å¾—å°ˆæ¡ˆ
git clone https://your.repo/AUTOA-RPA.git
cd AUTOA-RPA

# 2) å»ºç«‹è™›æ“¬ç’°å¢ƒä¸¦å®‰è£ä¾è³´
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt

# 3) å»ºç«‹è¨­å®šæª”
copy .env.example .env
copy config.example.yaml config.yaml

# 4) æ”¾å…¥ UI æ¨¡æ¿
# å°‡ä½ çš„ UI éŒ¨é»åœ–ç‰‡æ”¾åˆ° templates/ï¼ˆè¦‹ç¬¬ 6 ç¯€æŒ‡å¼•ï¼‰

5. å°ˆæ¡ˆçµæ§‹
AUTOA-RPA/
â”œâ”€ autoa/                   # æ ¸å¿ƒç¨‹å¼
â”‚  â”œâ”€ __init__.py
â”‚  â”œâ”€ rpa.py                # é»æ“Š/ç§»å‹•/æ‹–æ”¾/éµç›¤/ç†±éµ
â”‚  â”œâ”€ vision.py             # OpenCV æ¨¡æ¿æ¯”å°ã€å€åŸŸæœå°‹
â”‚  â”œâ”€ flow.py               # YAML ä»»å‹™ DSL è§£æèˆ‡åŸ·è¡Œå™¨
â”‚  â”œâ”€ guards.py             # ç¯€æµã€äººé¡åŒ–å»¶é²ã€é»‘åå–®
â”‚  â”œâ”€ ocr.py                # ï¼ˆå¯é¸ï¼‰Tesseract OCR ä»‹é¢
â”‚  â”œâ”€ win.py                # è¦–çª—èšç„¦/å‰æ™¯è™•ç†ï¼ˆpywinautoï¼‰
â”‚  â””â”€ utils.py              # æ—¥èªŒã€æˆªåœ–ã€é‡è©¦ã€æ™‚é–“å·¥å…·
â”œâ”€ tasks/                   # ä»»å‹™è…³æœ¬ï¼ˆYAMLï¼‰
â”‚  â””â”€ album_broadcast.yaml
â”œâ”€ templates/               # UI æ¨¡æ¿ï¼ˆPNGï¼‰
â”‚  â”œâ”€ btn_album.png
â”‚  â”œâ”€ btn_send.png
â”‚  â””â”€ ...
â”œâ”€ data/                    # åœ–ç‰‡ç´ æèˆ‡ç›¸ç°¿ä¾†æº
â”‚  â””â”€ album_2025W44/
â”œâ”€ lists/                   # å—çœ¾ã€é»‘åå–®ã€é€€è¨‚åå–® CSV
â”‚  â”œâ”€ recipients.csv
â”‚  â”œâ”€ blacklist.csv
â”‚  â””â”€ unsubscribe.csv
â”œâ”€ logs/                    # åŸ·è¡Œæ—¥èªŒ
â”œâ”€ reports/                 # å ±è¡¨èˆ‡æˆªåœ–è­‰æ“š
â”œâ”€ .env
â”œâ”€ config.yaml
â”œâ”€ requirements.txt
â””â”€ main.py                  # å…¥å£ï¼špython main.py run tasks/xxx.yaml

6. UI æ¨¡æ¿è£½ä½œæŒ‡å¼•ï¼ˆé—œéµï¼‰

DPI=100%ã€å›ºå®šèªç³»ï¼šè«‹åœ¨ã€Œå°‡è¦é‹è¡Œçš„ç’°å¢ƒã€æŠ“åœ–ã€‚

æŠ“å–æ¸…æ™°åœ–å¡Šï¼šåƒã€Œé€å‡ºã€ã€ã€Œç›¸ç°¿æŒ‰éˆ•ã€ã€ã€Œæœå°‹æ¡†åœ–ç¤ºã€ç­‰ï¼Œå„˜é‡å«æœ‰é«˜å°æ¯”ç‰¹å¾µã€‚

å‘½åï¼štemplates/btn_send.png, templates/ico_album.pngâ€¦

å¤§å°ï¼šä»¥å¯¦éš› UI åƒç´ ç‚ºæº–ï¼Œé¿å…ç¸®æ”¾å¾Œå¦å­˜ã€‚

é–€æª»ï¼ˆthresholdï¼‰ï¼šé è¨­ 0.92ï¼Œå¯ä¾ UI å·®ç•°åœ¨ YAML èª¿æ•´ 0.88â€“0.97ã€‚

å¤šæ¨£æ¿æ”¯æ´ï¼šåŒä¸€å…ƒç´ å¯æ”¾å¤šå¼µï¼ˆæ·ºè‰²/æ·±è‰²æ¨¡å¼ï¼‰ï¼›YAML ä¸­å¯çµ¦ templates: [a.png, b.png]ã€‚

7. è¨­å®šæª” config.yamlï¼ˆç¤ºä¾‹ï¼‰
screen:
  width: 1920
  height: 1080
  dpi_scale: 1.0

vision:
  default_threshold: 0.92
  timeout_sec: 10
  retries: 2
  search_region: null  # æˆ– [x, y, w, h] åªåœ¨å±€éƒ¨æ‰¾

delays:
  click_ms: [60, 120]
  type_ms: [40, 80]
  random_jitter_ms: [100, 600]

line:
  exe_path: "C:\\Users\\You\\AppData\\Local\\LINE\\bin\\LineLauncher.exe"
  lang: "zh-TW"

throttle:
  max_recipients_per_run: 50
  min_interval_sec: [15, 45]   # å–éš¨æ©Ÿå€¼
  daily_cap: 300

lists:
  recipients: "lists/recipients.csv"
  blacklist: "lists/blacklist.csv"
  unsubscribe: "lists/unsubscribe.csv"

logs:
  screenshot_on_fail: true
  record_screen: false


.envï¼ˆç¤ºä¾‹ï¼‰

AUTOA_ENV=dev
TESSERACT_PATH=C:\Program Files\Tesseract-OCR\tesseract.exe

8. ä»»å‹™ DSLï¼ˆYAMLï¼‰ç¯„ä¾‹ï¼šç›¸ç°¿å»£æ’­
name: album_broadcast
variables:
  album_title: "æœ¬é€±ç›¸ç°¿"
  album_dir: "data/album_2025W44"   # è¦ç™¼é€çš„åœ–ç‰‡è³‡æ–™å¤¾
limits:
  max_recipients: 40
  interval_sec: [18, 36]            # æ¯ä½ä¹‹é–“éš¨æ©Ÿå»¶é²
steps:
  - focus_app: { name: "LINE" }     # èšç„¦ LINE è¦–çª—
  - ensure_logged_in: {}            # ï¼ˆå¯é¸ï¼‰æª¢æŸ¥ç™»å…¥æ¨™èªŒæ¨¡æ¿

  # é–‹å•Ÿæœå°‹ï¼Œå®šä½æ”¶ä»¶è€…
  - locate_click: { template: "ico_search.png", threshold: 0.93 }
  - type_text:    { text: "{{recipient.name}}" }
  - press:        { keys: ["enter"] }
  - wait:         { sec: [0.8, 1.6] }

  # å»ºç«‹ç›¸ç°¿/æ’å…¥åœ–ç‰‡
  - locate_click: { template: "btn_album.png" }
  - wait:         { sec: [0.5, 1.0] }
  - click:        { x: "{{anchors.album.add.x}}", y: "{{anchors.album.add.y}}" }
  - upload_dir:   { path: "{{album_dir}}" }      # ç³»çµ±é–‹å•Ÿæª”æ¡ˆå°è©±æ¡†â†’è²¼è·¯å¾‘â†’Enter
  - wait:         { sec: [1.5, 3.0] }

  # è¼¸å…¥ç›¸ç°¿åç¨±ä¸¦é€å‡º
  - type_text:    { text: "{{album_title}}" }
  - press:        { keys: ["enter"] }

for_each_recipient:
  source: "lists/recipients.csv"    # æ¬„ä½éœ€åŒ…å« name æˆ– uid
  skip_if_blacklisted: true
  steps_ref: steps


å¯ç”¨å‹•ä½œä¸€è¦½

focus_app, ensure_logged_inï¼ˆæ¨¡æ¿æ ¡é©—ï¼‰

locate_clickï¼ˆä»¥æ¨¡æ¿æ¯”å°å®šä½ä¸¦é»æ“Šï¼›æ”¯æ´ templates: [], threshold, timeout_secï¼‰

click, move, drag_drop, scroll

type_text, pressï¼ˆkeys: ["ctrl","v"] ç­‰ï¼‰

upload_file, upload_dirï¼ˆç³»çµ±æª”æ¡ˆå°è©±æ¡†ï¼‰

waitï¼ˆå›ºå®šæˆ–å€é–“éš¨æ©Ÿï¼‰

for_each_recipientï¼ˆæ¸…å–®å›åœˆï¼Œå«é»‘åå–®è·³éã€é€ç­†å¤±æ•—é‡è©¦ï¼‰

assert_present / assert_absentï¼ˆæ¨¡æ¿å­˜åœ¨æ€§æ–·è¨€ï¼‰

screenshotï¼ˆå­˜è­‰ï¼‰

goto_step / labelï¼ˆå¿…è¦æ™‚æµç¨‹è·³è½‰ï¼‰

9. åŸ·è¡Œæ–¹å¼
# ä¹¾è·‘ï¼ˆä¸é»æ“Šï¼Œåªç•«æ¡†ç¤ºæ„ï¼‰
python main.py dryrun tasks/album_broadcast.yaml

# æ­£å¼åŸ·è¡Œ
python main.py run tasks/album_broadcast.yaml

# å¾ç‰¹å®šæ­¥é©ŸçºŒè·‘
python main.py run tasks/album_broadcast.yaml --from "type_text:album_title"

10. æ’ç¨‹ï¼ˆWindows æ’ç¨‹å™¨ï¼‰
# æ¯æ—¥ 10:00 åŸ·è¡Œä¸€æ¬¡
schtasks /Create /TN "AUTOA Album W44" /TR "\"C:\Path\to\python.exe\" C:\Path\to\AUTOA-RPA\main.py run C:\Path\to\AUTOA-RPA\tasks\album_broadcast.yaml" /SC DAILY /ST 10:00

11. åå–®èˆ‡ç¯€æµ

lists/recipients.csvï¼šname,uid,tags,...ï¼ˆæœ€å°‘ä¿ç•™ name æˆ– uid ä»¥ä¾¿æœå°‹ï¼‰

lists/blacklist.csvã€lists/unsubscribe.csvï¼šuid ä¸€è¡Œä¸€ç­†

ç¯€æµç­–ç•¥ï¼š

æ¯è¼ªä¸Šé™ max_recipients_per_run

æ¯ä½é–“éš” min_interval_secï¼ˆå€é–“éš¨æ©Ÿï¼‰

æ¯æ—¥ç¸½é‡ daily_cap

äººé¡åŒ–ï¼šé»æ“Š/è¼¸å…¥/ç­‰å¾…éƒ½æ¡éš¨æ©ŸæŠ–å‹•ï¼Œé¿å…å›ºå®šç¯€å¥

12. æ—¥èªŒèˆ‡å­˜è­‰

logs/autoa.logï¼šé—œéµäº‹ä»¶ã€éŒ¯èª¤å †ç–Š

reports/ï¼šå¤±æ•—æˆªåœ–ã€ï¼ˆå¯é¸ï¼‰å…¨ç¨‹éŒ„å½±ç‰‡æ®µ

æ¯ç­†æ”¶ä»¶è€…å½¢æˆä¸€ç­†è¨˜éŒ„ï¼šrecipient, status, retries, timestamp

13. å¸¸è¦‹å•é¡Œï¼ˆFAQï¼‰

Q1ï¼šæ‰¾ä¸åˆ°æ¨¡æ¿/ä¸€ç›´é€¾æ™‚

ç¢ºèªè§£æåº¦ã€DPI=100%ã€æ·±/æ·ºè‰²æ¨¡å¼èˆ‡æŠ“åœ–æ™‚ä¸€è‡´

èª¿é™ threshold è‡³ 0.90â€“0.92 è©¦è©¦

æŒ‡å®š search_region é™ç¸®æœå°‹ç¯„åœåŠ é€Ÿèˆ‡æ¸›å°‘èª¤åˆ¤

Q2ï¼šå¤šè¢å¹•å®šä½éŒ¯ä½

å°‡ LINE å›ºå®šæ–¼ä¸»è¢å¹•ï¼Œæˆ–åœ¨ win.py å…§å…ˆç§»å‹•è¦–çª—è‡³ (0,0)

Q3ï¼šæ‹–æ”¾/ä¸Šå‚³å°è©±æ¡†ç„¡åæ‡‰

è©¦ upload_fileï¼ˆè²¼è·¯å¾‘ + Enterï¼‰æ›¿ä»£æ‹–æ”¾

æª¢æŸ¥æ˜¯å¦æœ‰ç³»çµ±ç®¡ç†å“¡æ¬Šé™è¡çªï¼ˆAdmin èˆ‡é Admin ä¹‹é–“ï¼‰

Q4ï¼šéµç›¤èªç³»å°è‡´å¿«æ·éµéŒ¯èª¤

å°‡ç³»çµ±è¼¸å…¥æ³•åˆ‡æ›ç‚º EN-USï¼ˆè‹±æ–‡ï¼‰å†åŸ·è¡Œ

14. æ“´å……å»ºè­°

OCR æ ¡é©—ï¼šå°æœå°‹æ¡†æˆ–æ¨™é¡Œé€²è¡Œæ–‡å­—æ¯”å°ï¼Œæé«˜æˆåŠŸç‡

pywinauto å…ƒä»¶è·¯å¾‘ï¼šåœ¨å¯èƒ½çš„æƒ…æ³ä¸‹ä»¥æ§ä»¶æ¨¹è¼”åŠ©å®šä½

å®¹å™¨åŒ–ï¼šå°è£æˆ portable å¥—ä»¶æˆ–ä»¥ PyInstaller æ‰“åŒ…

GUI å¾Œå°ï¼šæä¾›ä»»å‹™ç®¡ç†ã€åå–®ç®¡ç†ã€æ’ç¨‹ã€å ±è¡¨åŒ¯å‡º

15. åˆè¦/éš±ç§å»ºè­°ï¼ˆå‹™å¿…ï¼‰

åƒ…ç™¼é€çµ¦å·²åŒæ„æ¥æ”¶ä¹‹å°è±¡ï¼Œä¸¦æä¾›é€€è¨‚é€šé“

åš´æ ¼æ§åˆ¶ç¯€æµï¼Œé¿å…é€ æˆé¨·æ“¾æˆ–è§¸ç™¼ç³»çµ±é˜²è­·

ä¸è’é›†ç„¡å¿…è¦çš„å€‹è³‡ï¼Œæ—¥èªŒå»è­˜åˆ¥åŒ–æˆ–æœ€å°åŒ–ä¿å­˜

ä¾åœ°æ–¹æ³•è¦ï¼ˆå¦‚ GDPRï¼‰ç¢ºä¿è³‡æ–™è™•ç†èˆ‡ä¿å­˜åˆæ³•

16. ç‰ˆæœ¬ç­–ç•¥èˆ‡è®Šæ›´ç´€éŒ„

ç‰ˆæœ¬è™Ÿï¼šMAJOR.MINOR.PATCH

v0.1.0ï¼šåˆç‰ˆ READMEã€ä»»å‹™ DSLã€æ¨¡æ¿è£½ä½œæŒ‡å¼•ã€MVP çµæ§‹èªªæ˜

17. æˆæ¬Š

å»ºè­°ä»¥ MIT æˆæ¬Šï¼ˆåƒ…ä¾›åƒè€ƒï¼Œå¯ä¾å¯¦éš›æƒ…æ³èª¿æ•´ï¼‰ã€‚