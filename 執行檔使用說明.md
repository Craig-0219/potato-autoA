# LINE Auto RPA - 執行檔使用說明

## 📦 檔案位置
執行檔位於: `dist/LINE_Auto_RPA.exe`

## 🚀 使用方式

### 第一次使用
1. 將 `LINE_Auto_RPA.exe` 複製到任意資料夾
2. 確保該資料夾包含以下檔案/資料夾:
   - `config.yaml` (設定檔)
   - `templates/` (UI 模板圖片)
   - `tasks/` (任務腳本)
   - `data/` (圖片素材)
   - `.env` (環境變數)
3. 雙擊執行 `LINE_Auto_RPA.exe`

### 注意事項

#### ✅ 優點
- **單一檔案**: 所有 Python 依賴已打包,不需要安裝 Python
- **可攜式**: 可以複製到任何 Windows 電腦執行
- **自訂圖示**: 使用專案圖示,易於識別
- **無控制台視窗**: 純 GUI 介面,不會出現 cmd 黑視窗

#### ⚠️ 重要提醒
1. **首次執行**: 第一次執行時可能需要 10-20 秒啟動 (解壓臨時檔案)
2. **防毒軟體**: 某些防毒軟體可能誤判,請加入白名單
3. **資源檔案**: 執行檔需要搭配 `templates/`、`tasks/`、`config.yaml` 等資料夾/檔案
4. **執行權限**: 建議以一般使用者權限執行,除非遇到 UAC 問題

#### 📂 建議資料夾結構
```
LINE_Auto_RPA/
├── LINE_Auto_RPA.exe    ← 執行檔
├── config.yaml           ← 主要設定檔
├── .env                  ← 環境變數
├── templates/            ← UI 模板圖片
│   ├── btn_send.png
│   └── ...
├── tasks/                ← 任務腳本
│   └── album_broadcast.yaml
├── data/                 ← 圖片素材
│   └── album_2025W44/
├── lists/                ← 收件人清單 (選用)
│   ├── recipients.csv
│   └── blacklist.csv
├── logs/                 ← 日誌 (自動建立)
└── reports/              ← 報表 (自動建立)
```

## 🔧 重新打包

如果需要修改程式碼並重新打包:

```bash
# 1. 修改程式碼後,執行打包指令
python -m PyInstaller line_auto.spec --clean

# 2. 新的執行檔會在 dist/ 資料夾生成
```

## 📝 打包配置說明

打包使用的設定檔: `line_auto.spec`

### 主要配置:
- **單一執行檔模式**: `--onefile`
- **無控制台視窗**: `console=False` (GUI 應用)
- **自訂圖示**: `icon='icon.ico'`
- **包含資料**: templates, tasks, data, lists 資料夾
- **UPX 壓縮**: 減少檔案大小

### 隱藏導入模組:
已自動包含以下模組:
- PIL._tkinter_finder
- numpy, cv2
- pyautogui, pywinauto
- pytesseract
- apscheduler
- dotenv, yaml, loguru

## 🐛 疑難排解

### 問題 1: 執行檔無法啟動
**解決方案**:
- 確認防毒軟體未阻擋
- 檢查是否缺少必要的資料檔案 (config.yaml, templates/ 等)

### 問題 2: 找不到模板/UI 元素
**解決方案**:
- 確認 `templates/` 資料夾與執行檔在同一目錄
- 檢查 config.yaml 中的路徑設定

### 問題 3: 防毒軟體誤判
**解決方案**:
- 將執行檔加入防毒軟體白名單
- 這是 PyInstaller 打包的常見問題,執行檔本身是安全的

### 問題 4: 執行檔太大 (86MB)
**說明**:
- 包含了 OpenCV, NumPy, Pandas 等大型函式庫
- 這是正常大小,已啟用 UPX 壓縮

## 📞 技術支援

如有問題,請參考:
- 專案 README: `README.md`
- 設定範例: `config.example.yaml`
- 環境變數範例: `.env.example`

---
**版本**: v1.0.2
**打包工具**: PyInstaller 6.16.0
**Python 版本**: 3.13.7
**建置日期**: 2025-11-06 19:28

## 🔄 更新日誌

### v1.0.2 (最新版)
- ✅ 修正執行時閃現 cmd 視窗的問題
- ✅ 修正 templates 資料夾打包問題
- ✅ 確保影像辨識功能正常運作
